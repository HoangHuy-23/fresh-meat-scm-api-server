# server/connection-profile.yaml
name: "fresh-meat-network"
version: "1.0.0"

# Client section remains the same, it's case-insensitive here
client:
  organization: MeatSupplyOrg
  logging:
    level: info
  # Peer timeout cho Fabric 2.5
  peer:
    timeout:
      connection: 10s
      response: 180s
      discovery:
        greylistExpiry: 10s

  # Event service timeout
  eventService:
    timeout:
      connection: 15s
      registrationResponse: 15s

  # Order timeout
  order:
    timeout:
      connection: 15s
      response: 15s

  # Global timeout
  global:
    timeout:
      query: 180s
      execute: 180s
      resmgmt: 180s
    cache:
      connectionIdle: 30s
      eventServiceIdle: 2m
      channelConfig: 30s
      channelMembership: 30s

# =================================================================
# MỤC MỚI QUAN TRỌNG: CHANNELS
# =================================================================
channels:
  meatchannel:
    orderers:
      - orderer1.meatsupply.example.com
      - orderer2.meatsupply.example.com
      - orderer3.regulator.example.com
    peers:
      peer0.meatsupply.example.com:
        endorsingPeer: true
        chaincodeQuery: true
        ledgerQuery: true
        eventSource: true
      peer0.regulator.example.com:
        endorsingPeer: true
        chaincodeQuery: true
        ledgerQuery: true
        eventSource: true

organizations:
  MeatSupplyOrg:
    mspid: MeatSupplyOrgMSP
    peers:
      - peer0.meatsupply.example.com
    certificateAuthorities:
      - ca.meatsupply.example.com
    users:
      superadmin:
        cert:
          path: /home/hhexe/fresh-meat-scm-hyperledger-fabric/network/crypto-config/peerOrganizations/meatsupply.example.com/users/SuperAdmin@meatsupply.example.com/msp/signcerts/cert.pem
        key:
          path: /home/hhexe/fresh-meat-scm-hyperledger-fabric/network/crypto-config/peerOrganizations/meatsupply.example.com/users/SuperAdmin@meatsupply.example.com/msp/keystore/17627360525d4b077f1613292875153bd63c94161d9d473ebb6901f1ae0cb2c6_sk
  # Thêm định nghĩa cho RegulatorOrg để SDK biết về nó
  RegulatorOrg:
    mspid: RegulatorOrgMSP
    peers:
      - peer0.regulator.example.com
    certificateAuthorities:
      - ca.regulator.example.com
    cryptoPath: /home/hhexe/fresh-meat-scm-hyperledger-fabric/network/crypto-config/peerOrganizations/regulator.example.com/users/Admin@regulator.example.com/msp

orderers:
  orderer1.meatsupply.example.com:
    url: grpcs://localhost:7050
    tlsCACerts:
      path: /home/hhexe/fresh-meat-scm-hyperledger-fabric/network/crypto-config/ordererOrganizations/example.com/orderers/orderer1.meatsupply.example.com/tls/ca.crt
    grpcOptions:
      ssl-target-name-override: orderer1.meatsupply.example.com
      hostnameOverride: orderer1.meatsupply.example.com

  orderer2.meatsupply.example.com:
    url: grpcs://localhost:8050
    tlsCACerts:
      path: /home/hhexe/fresh-meat-scm-hyperledger-fabric/network/crypto-config/ordererOrganizations/example.com/orderers/orderer2.meatsupply.example.com/tls/ca.crt
    grpcOptions:
      ssl-target-name-override: orderer2.meatsupply.example.com
      hostnameOverride: orderer2.meatsupply.example.com

  orderer3.regulator.example.com:
    url: grpcs://localhost:9050
    tlsCACerts:
      path: /home/hhexe/fresh-meat-scm-hyperledger-fabric/network/crypto-config/ordererOrganizations/example.com/orderers/orderer3.regulator.example.com/tls/ca.crt
    grpcOptions:
      ssl-target-name-override: orderer3.regulator.example.com
      hostnameOverride: orderer3.regulator.example.com

peers:
  peer0.meatsupply.example.com:
    url: grpcs://localhost:7051
    tlsCACerts:
      path: /home/hhexe/fresh-meat-scm-hyperledger-fabric/network/crypto-config/peerOrganizations/meatsupply.example.com/peers/peer0.meatsupply.example.com/tls/ca.crt
    grpcOptions:
      ssl-target-name-override: peer0.meatsupply.example.com
      hostnameOverride: peer0.meatsupply.example.com

  peer0.regulator.example.com:
    url: grpcs://localhost:9051
    tlsCACerts:
      path: /home/hhexe/fresh-meat-scm-hyperledger-fabric/network/crypto-config/peerOrganizations/regulator.example.com/peers/peer0.regulator.example.com/tls/ca.crt
    grpcOptions:
      ssl-target-name-override: peer0.regulator.example.com
      hostnameOverride: peer0.regulator.example.com

certificateAuthorities:
  ca.meatsupply.example.com:
    url: https://localhost:7054
    caName: ca.meatsupply.example.com
    tlsCACerts:
      path: /home/hhexe/fresh-meat-scm-hyperledger-fabric/network/crypto-config/fabric-ca/meatsupply/ca-cert.pem
    httpOptions:
      verify: false
    registrar:
      enrollId: admin
      enrollSecret: adminpw
  # Thêm định nghĩa cho CA của RegulatorOrg
  ca.regulator.example.com:
    url: https://localhost:8054
    caName: ca.regulator.example.com
    tlsCACerts:
      path: /home/hhexe/fresh-meat-scm-hyperledger-fabric/network/crypto-config/fabric-ca/regulator/ca-cert.pem
    httpOptions:
      verify: false
    registrar:
      enrollId: admin
      enrollSecret: adminpw
